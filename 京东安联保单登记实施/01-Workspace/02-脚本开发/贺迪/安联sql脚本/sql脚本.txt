保单佣金信息表（ProCcommission）
----------------------------------------------

SELECT
    NULL AS TRANSACTIONNO,
    NULL AS COMPANYCODE,
    MA.POLICYNO AS POLICYNO	,
    MA.RISKCODE AS RISKCODE,
    COM.CURRENCY AS CURRENCY,
    COM.COSTFEE AS SUMCOSTFEE,
    COM.COSTRATE AS POLICYCOSTRATE,
    NULL AS TRANSACTIONDATE,
    NULL AS BATCHNO
FROM PRPCCOMMISSION COM
    LEFT JOIN PRPCMAIN MA ON MA.ID = COM.MAINID
=======================================================

理赔报案处理信息表(ProLRegistDeal)
----------------------------------------------
SELECT
    NULL AS TRANSACTIONNO,
    NULL AS COMPANYCODE,
    PLR.POLICYNO AS POLICYNO,
    PLR.REGISTNO AS REGISTNO,
    PLR.CANCELREASON AS REGISTDEALTYPECODE,
    PLR.REPORTTIME AS DEALTIME,
    CASE WHEN PLR.CANCELREASON = '03' THEN '03'
    ELSE PLR.CANCELREASON
    END AS NOCLAIMREASON,
    CASE WHEN PLR.CANCELREASON = '04' THEN '1900-01-01 00:00:00'
    ELSE ''
    END AS REGISTCANCELRECOVERDATE,
    CASE WHEN PLR.CANCELREASON = '04' THEN '9999999999'
    ELSE ''
    END AS REGISTCANCELRECOVERNO,
    PLR.MAKECOME AS ACCEPTANCECODE,
    '' AS ACCEPTANCENAME,
    NULL AS TRANSACTIONDATE,
    NULL AS BATCHNO 
FROM
    PRPLREGIST PLR
===============================================



理赔人伤明细信息表(ProLClaimInjuryDetail)
------------------------------------------------
SELECT
	PC.POLICYNO AS POLICYNO,
	PC.REGISTNO AS REGISTNO,
	PC.CLAIMNO AS CLMNO,
	PC.CASENO AS CASENO,
	PLC.COMPENSATENO AS COMPENSATENO,
	PLLP.ITEMKINDNO AS ITEMKINDNO,
	--  SERIALNO是将PLLPF.COMPENSATENO分组后编号获取
  -- 	ROW_NUMBER() OVER(PARTITION BY PLLPF.COMPENSATENO ORDER BY PLLPF.COMPENSATENO) AS SERIALNO，
-- 	ROW_NUMBER() OVER(PARTITION BY PLLPF.COMPENSATENO ORDER BY PLLPF.COMPENSATENO) AS EMPNO，
	PLLP.RISKCODE AS RISKCODE,
	PLLP.CLAUSECODE AS CLAUSECODE,
	PLLP.KINDCODE AS KINDCODE,
	NULL AS ONELOSSCODE,
	NULL AS ONELOSSNAME,
	NULL AS TWOLOSSCODE,
	NULL AS TWOLOSSNAME,
	NULL AS THREELOSSCODE,
	NULL AS THREELOSSNAME,
	NULL AS FOURLOSSCODE,
	NULL AS FOURLOSSNAME,
	PC.DAMAGECODE AS OCCREASONCODE,
	PC.DAMAGENAME AS OCCREASONNAME,
	PLLP.PERSONNAME AS EMPNAME,
	PLLP.PERSONSEX AS SEX,
	PLLP.PERSONAGE AS AGE,
	PLLP.CERTITYPE AS CERTTYPE,
	PLLP.CERTICODE AS CERTNO,
	PLLP.DUTYRATE AS INDEMNITYDUTYRATE,
	PLLP.CURRENCY AS DEDUCTIBLEORIGCUR,
	PLLP.DEDUCTABSAMT AS DEDUCTIBLEORIG,
	PLLP.DEDUCTABSAMT AS DEDUCTIBLE,
	PLLP.DEDUCTADDRATE AS DEDUCTIBLERATE,
	PLLPF.FORMULA AS UNITCOMPENSATEEXP,
	PLLP.CURRENCY AS STANDPAYORIGCUR,
	PLLP.SUMREALPAY AS STANDPAYORIG,
	PLLP.SUMREALPAY * PLLP.EXCHRATE AS STANDPAY,
	PLLP.CURRENCY AS CURRENCY,
	PLLP.OFFPREAMT AS UNITSUMPREPAIDORIG,
	PLLP.OFFPREAMT * PLLP.EXCHRATE AS UNITSUMPREPAID,
	PLLP.CURRENCY AS UNITSUMREALPAYORIGCUR,
	PLLP.SUMREALPAY AS UNITSUMREALPAYORIG,
	PLLP.SUMREALPAY * PLLP.EXCHRATE AS UNITSUMREALPAY,
	PLLP.CURRENCY AS UNITEXCEPTDEDUCTIBEORIGCUR,
	PLLP.DEDUCTOFFAMT AS UNITEXCEPTDEDUCTIBEORIG,
	PLLP.DEDUCTOFFAMT * PLLP.EXCHRATE AS UNITEXCEPTDEDUCTIBE,
	PLC.UNDERWRITEDATE AS UNDERWRITEENDDATE,
	PLC.PAYSTATUS AS PFSTATUS,
	PC.RELATERECOVERY AS RECOVERYFLAG,
	PLC.LAWSUITFLAG AS LAWSUITFLAG,
	'' AS LAWSUITNO,
	'000000' AS GIVETYPE,
	PLC.REMARK AS GIVETYPEDESCRIPTION,
	'' AS REFUSEPAYRCODE,
	'' AS GETDUTYKIND,
	'' AS LOSSFEETYPE,
	'' AS CRITICALILLNESSCODE,
	PLLPF.CLAIMRATE AS CLAIMRATE,
	'' AS CLAIMRATIOEND,
	PLC.COMCODE AS UNDERWRITECOMCODE,
	'' AS UNDERWRITECOMNAME,
	NULL AS TRANSACTIONDATE,
	NULL AS BATCHNO 
FROM
	PRPLCLAIM PC,
	PRPLCOMPENSATE PLC,
	PRPLLOSSPERSON PLLP,
	PRPLLOSSPERSONFEE PLLPF 
WHERE
	PC.CLAIMNO = PLC.CLAIMNO 
	AND PLC.COMPENSATENO = PLLP.COMPENSATENO 
	AND PLLP.COMPENSATENO = PLLPF.COMPENSATENO 
	AND PLC.COMPENSATENO = PLLPF.COMPENSATENO

===================================================================================


理赔费用信息表(ProLClaimExpense)
-----------------------------------------------------------------

     SELECT
        NULL AS TRANSACTIONNO,
        NULL AS COMPANYCODE,
        CLA.POLICYNO AS POLICYNO,
        CLA.REGISTNO AS REGISTNO,
        CLA.CLAIMNO AS CLMNO,
        CLA.CASENO AS CASENO,
        CHA.COMPENSATENO AS COMPENSATENO,
				--  函数算序号
        -- 	ROW_NUMBER() OVER(PARTITION BY CHA.COMPENSATENO ORDER BY CHA.COMPENSATENO) AS SERIALNO,
        NULL AS ITEMKINDNO,
        '000000' AS CLAIMEXPFLAG,
        CHA.CHARGECODE AS FEETYPECODE,
        CHA.CHARGENAME AS FEETYPENAME,
        CHA.CURRENCY AS CURRENCY,
        CHA.FEEAMT AS EXPAMOUNT,
        CHA.EXCHRATE AS EXCHANGE,
        CHA.FEEAMT*CHA.EXCHRATE AS EXPAMOUNTCNY,
        CASE AG.AGENCYTYPE WHEN '01' THEN AG.AGENCYCODE
        ELSE ''
        END AS ADJUSTERCODE,
        CASE AG.AGENCYTYPE WHEN '01' THEN AG.AGENCYNAME
        ELSE ''
        END AS ADJUSTERNAME,
        NULL AS TRANSACTIONDATE,
        NULL AS BATCHNO
      FROM
        PRPLCHARGE CHA,
        PRPLCLAIM CLA,
        PRPLCOMPENSATE COM,
        PRPLREGIST REG,
        PRPLAGENCY AG
      WHERE
        CLA.CLAIMNO = COM.COMPENSATENO
        AND CHA.COMPENSATENO = COM.COMPENSATENO
        AND CLA.REGISTNO = REG.REGISTNO
        AND AG.REGISTNO = CLA.REGISTNO

====================================================================================

理赔自然人受益人信息表(ProLBnf)
-----------------------------------------------------------------------

SELECT
    NULL AS TRANSACTIONNO,
    NULL AS COMPANYCODE,
    COM.POLICYNO AS POLICYNO,
    COM.REGISTNO AS REGISTNO,
    COM.CLAIMNO AS CLMNO,
    COM.CASENO AS CASENO,
    BEN.BENEFITORDER AS BNFSERIALNUM,
    CLA.SERIALNO AS INSUREDNO,
    '000000' AS BNFTYPE,
    BEN.BENEFITORDER AS BNFGRADE,
    '' AS RELATIONTOINSURED,
    BEN.BENEFICIARYNAME AS BNFNAME,
    BEN.SEX AS BNFSEX,
    BEN.BIRTHDAY AS BNFBIRTHDAY,
    BEN.IDENTIFYTYPE AS BNFIDENTIFYTYPE,
    BEN.IDENTIFYNO AS BNFIDENTIFYNUMBER,
    NULL AS BENEFITIHGCODE,
    NULL AS BENEFITCOUNTRYCODE ,
    NULL AS BENEFITPROVINCE,
    NULL AS BENEFITCITY,
    NULL AS BENEFITCOUNTY,
    NULL AS BENEFITDETAILADD,
    NULL AS BENEFITPOSTCODE,
    BEN.BENEFITRATE AS BNFLOT,
    INFO.SUMREALPAY AS GETMONEY,
    BEN.PAYEERALATIONSHIP AS RELATIONTOPAYEE,
    PAY.ACCOUNTNO AS PAYEENO,
    PAY.PAYEENAME AS PAYEENAME,
    '' AS PAYEESEX,
    PAY.BIRTHDAY AS PAYEEBIRTHDAY,
    PAY.CERTIFYTYPE AS PAYEEIDTYPE,
    PAY.CERTIFYNO AS PAYEEIDNO,
    NULL AS PAYIHGCODE,
    NULL AS PAYCOUNTRYCODE,
    NULL AS PAYPROVINCE,
    NULL AS PAYCITY,
    NULL AS PAYCOUNTY,
    NULL AS PAYDETAILADD,
    NULL AS PAYPOSTCODE,
    NULL AS CASEGETMODE,
    NULL AS CASEPAYMODE,
    -- 下面四个字段支付方式为银行卡或银行类转账必填，现无字段判断
    '000000' AS BANKCODE,
    PAY.BANKNAME AS BANKNAME,
    PAY.PAYEENAME AS  ACCNAME,
    PAY.ACCOUNTNO AS  BANKACCNO,
    NULL AS CUSTOMERNO,
    NULL AS PAYCUSTOMERNO,
    NULL AS TRANSACTIONDATE,
    NULL AS BATCHNO
FROM PRPLBENEFICIARY BEN
    LEFT JOIN PRPLCLAIM CLA ON  BEN.REGISTNO = CLA.REGISTNO
    LEFT JOIN PRPLCOMPENSATE COM ON  COM.REGISTNO = CLA.REGISTNO
    LEFT JOIN PRPLPAYPERSON PAY ON PAY.REGISTNO = COM.REGISTNO
    LEFT JOIN PRPLPAYEEINFO INFO ON INFO.PAYEEID = PAY.ID
WHERE COM.UNDERWRITEFLAG IN('1', '3')

============================================================================

理赔非自然人受益人信息表(ProLGrpbnf)
---------------------------------------------------------------------------
SELECT
    NULL AS TRANSACTIONNO,
    NULL AS COMPANYCODE,
    COM.POLICYNO AS POLICYNO,
    INFO.REGISTNO AS REGISTNO,
    COM.CLAIMNO AS CLMNO,
    COM.CASENO AS CASENO,
    -- 	ROW_NUMBER() OVER(PARTITION BY INFO.COMPENSATENO ORDER BY INFO.ID) AS BNFNO,
    NULL AS IHGCODE,
    NULL AS COUNTRYCODE,
    NULL AS PROVINCE,
    NULL AS CITY,
    NULL AS COUNTY,
    NULL AS DETAILADD,
    NULL AS POSTCODE,
    BEN.BENEFITORDER AS BNFGRADE,
    PAY.CERTIFYTYPE AS IDTYPE,
    PAY.CERTIFYNO AS IDNO,
    BEN.PAYEERALATIONSHIP AS RELATIONTOINSURED,
    COM.INSUREDCODE AS INSUREDNO,
    BEN.BENEFITRATE AS BNFLOT,
    INFO.SUMREALPAY AS GETMONEY,
    '' AS CASEGETMODE,
    '' AS CASEPAYMODE,
    -- 下面四个字段支付方式为银行卡或银行类转账必填，现无字段判断
    '000000' AS BANKCODE,
    PAY.BANKNAME AS BANKNAME,
    PAY.PAYEENAME AS  ACCNAME,
    PAY.ACCOUNTNO AS  BANKACCNO,
    NULL AS CUSTOMERNO,
    NULL AS TRANSACTIONDATE,
    NULL AS BATCHNO
FROM PRPLBENEFICIARY BEN
    LEFT JOIN PRPLCLAIM CLA ON BEN.REGISTNO = CLA.REGISTNO
    LEFT JOIN PRPLCOMPENSATE COM ON COM.REGISTNO = CLA.REGISTNO
    LEFT JOIN PRPLPAYPERSON PAY ON PAY.REGISTNO = COM.REGISTNO
    LEFT JOIN PRPLPAYEEINFO INFO ON INFO.PAYEEID = PAY.ID
WHERE COM.UNDERWRITEFLAG IN('1', '3')